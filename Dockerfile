FROM php:5.6-apache

# Оновлюємо джерела пакетів на архівовані репозиторії
RUN sed -i -e 's/deb.debian.org/archive.debian.org/g' \
           -e 's|security.debian.org|archive.debian.org/|g' \
           -e '/stretch-updates/d' /etc/apt/sources.list

# Оновлюємо пакети та встановлюємо необхідні
RUN apt-get update && \
    apt-get install --yes --force-yes \
        cron \
        g++ \
        gettext \
        libicu-dev \
        openssl \
        libc-client-dev \
        libkrb5-dev \
        libxml2-dev \
        libfreetype6-dev \
        libgd-dev \
        libmcrypt-dev \
        bzip2 \
        libbz2-dev \
        libtidy-dev \
        libcurl4-openssl-dev \
        libz-dev \
        libmemcached-dev \
        libxslt1-dev \
        zlib1g-dev \
        && apt-get clean

# Включаємо mod_rewrite в Apache
RUN a2enmod rewrite

# Встановлюємо розширення PHP
RUN docker-php-ext-install \
        mysqli \
        gd \
        xsl \
        zip

# Налаштовуємо PHP GD з необхідними параметрами
RUN docker-php-ext-configure gd --with-freetype-dir=/usr --with-jpeg-dir=/usr --with-png-dir=/usr

# Копіюємо файли до контейнера
COPY ./ /var/www/html/

# Налаштовуємо права доступу
RUN chmod -R 755 /var/www/html